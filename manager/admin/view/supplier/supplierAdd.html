{include file="./public/Public/meta.html" /}

<meta charset="utf-8">
<title>添加商家 - 商家管理</title>
<link href="<?php echo CSS_PATH;?>lib/webuploader/0.1.5/webuploader.css" rel="stylesheet" type="text/css" />
</head>
<body>
<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 商家管理 <span class="c-gray en">&gt;</span> 添加商家 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a></nav>
<div class="page-container">
	<form action="{:url('Supplier/supplierAdd',['act'=>'add'])}" enctype="multipart/form-data" method="post" class="form form-horizontal" id="form_aupplier_add">
		<div class="row cl">
            <label class="form-label col-xs-2 col-sm-2"><span class="c-red">*</span>商家名称：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="name" name="name">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-2 col-sm-2"><span class="c-red">*</span>商家分类：</label>
			<div class="formControls col-xs-10 col-sm-9"> <span class="select-box">
				<select name="suppliertypeid" class="select">
                    {volist name="suppliertype" id="voc"}
                    <option value="{$voc.ID}">{$voc.SupplierTypeName}</option>
                    {/volist}
				</select>
				</span> </div>
		</div>
        <div class="row cl" style="display: none">
            <label class="form-label col-xs-2 col-sm-2">推荐人ID：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="ReferrerID" name="ReferrerID" onBlur="JudgeUserName();"><span class="c-red" id="showResult"></span>
			</div>
		</div>
        <div class="row cl">
            <label class="form-label col-xs-2 col-sm-2"><span class="c-red">*</span>登录密码：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="hc123456" placeholder="" id="loginpasswd" name="loginpasswd">
			</div>
		</div>
        <div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">手机：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="mobile" name="mobile">
			</div>
		</div>
        <div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">负责人微信：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="wechatname" name="wechatname">
			</div>
		</div>
        <div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">售后客服电话：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="telphone" name="telphone">
			</div>
		</div>
        <div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">银行账号：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="bankaccount" name="bankaccount">
			</div>
		</div>      
        <div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">开户行：</label>
			<div class="formControls col-xs-10 col-sm-9"> 
                <span class="select-box">
                    <select class="select" size="1" name="bankname" id="bankname">
                        <option value="" selected>请选择开户银行</option>
                        <option value="中国银行">中国银行</option>
                        <option value="中国工商银行">中国工商银行</option>
                        <option value="中国建设银行">中国建设银行</option>
                        <option value="中国农业银行">中国农业银行</option>
                        <option value="中国农商银行">中国农商银行</option>
                        <option value="河南农村信用社">河南农村信用社</option>
                        <option value="中国交通银行">中国交通银行</option>
                        <option value="中国光大银行">中国光大银行</option>
                        <option value="中国招商银行">中国招商银行</option>
                        <option value="中国邮政储蓄">中国邮政储蓄</option>
                        <option value="中国邮政储蓄">中国兴业银行</option>
                        <option value="中国民生银行">中国民生银行</option>
                    </select>
				</span>
            </div>
		</div>
        <div class="row cl">
            <label class="form-label col-xs-2 col-sm-2">开户行地址：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="bankinfo" name="bankinfo">
			</div>
		</div>
        <div class="row cl">
            <label class="form-label col-xs-2 col-sm-2">开户人：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="" id="banksupname" name="banksupname">
			</div>
		</div>
        <div class="row cl">
            <label class="form-label col-xs-2 col-sm-2">商家网址：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" value="" placeholder="请输入域名，不必添加http://" id="supnetwork" name="supnetwork">
			</div>
		</div>  
<!--        <div class="row cl">
            <label class="form-label col-xs-2 col-sm-2"><span class="c-red">*</span>结算方式：</label>
			<div class="formControls col-xs-10 col-sm-9 skin-minimal">
				<div class="radio-box">
					<input name="jesan" type="radio" value="周结" id="jesan-1" checked>
					<label for="sex-1">周结</label>
				</div>
				<div class="radio-box">
					<input type="radio" id="jesan-2" value="月结" name="jesan">
					<label for="sex-2">月结</label>
				</div>
			</div>
		</div>-->      
        <div class="row cl">
            <label class="form-label col-xs-2 col-sm-2"><span class="c-red">*</span>主营产品：</label>
			<div class="formControls col-xs-10 col-sm-9 ">
                <select class="select select-box" size="1" name="supproduct[]" id="supproductcate" onchange="Cmd(this)">
                    <option value="" selected>请选择经营类别</option>
                    {volist name="listonly" id="voonly"}
                    <option value="{$voonly.id}">{$voonly.name}</option>
                    {/volist}
                </select>
                <div>
               		{volist name="listone" id="voone"}<!--循环第一级别-->
                    <div class="permission-list" id="x{$voone.id}" style="display:none">
                        {volist name="voone['voo']" id="votwo"} <!--循环第二级别-->
                        <dl class="cl permission-list2">
                            <dt class="lh-30 pl-10" style="background-color:#EFEFEF">
                                <label class=""><input type="checkbox" value="{$votwo.id}" name="supproduct[]" id="procate_{$votwo.id}"> {$votwo.name}</label>
                            </dt>
                            <dd class="pl-10 mt-10 mb-10">   
                                {volist name="votwo['boo']" id="vothree"} <!--循环第三级别-->
                                <label class="ml-15"><input type="checkbox" value="{$vothree.id}" name="supproduct[]" id="procate_{$vothree.id}"> {$vothree.name}</label>
                                {/volist}
                            </dd>
                        </dl>
                        {/volist}
                    </div>
                	{/volist}
                </div>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">所在地：</label>
			<div class="formControls col-xs-10 col-sm-9"> 
				<select id="cmbProvince" class="select select-box" name="province" style="width:150px"></select>
                <select id="cmbCity" class="select select-box" name="city" style="width:200px"></select>
                <select id="cmbArea" class="select select-box" name="area" style="width:120px"></select>
            </div>
		</div>
        <div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">详细地址：</label>
			<div class="formControls col-xs-10 col-sm-9"> 
                    <input type="text" class="input-text" value="" placeholder="" id="address" name="address" style="width:50%">
            </div>
		</div>
		<div class="row cl">
        	<label class="form-label col-xs-2 col-sm-2">企业资质：</label>
			<div class="formControls col-xs-10 col-sm-9 text-l" id="optionContainer">
                  <div id="option0">
                      <span class="btn-upload form-group">
                          <input class="input-text upload-url radius" type="text" name="photo[]" id="photo[]" readonly>
                          <a href="javascript:void();" class="btn btn-primary radius upload-btn"><i class="Hui-iconfont">&#xe642;</i> 浏览文件</a>
                          <input type="file" multiple name="photo[]" class="input-file">
                      </span>
                      <a class="btn btn-default" href="###" onClick="addRow()">添加一行</a>
                  </div>
			</div>
		  
		</div>
		<div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">商家介绍：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<script id="container" name="content" type="text/plain" style="width:100%;height:600px;"></script>
				<textarea id="container" name="content" style="display:none"></textarea>
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-2 col-sm-2"><span class="c-red">*</span>商家提现方式：</label>
			<div class="formControls col-xs-10 col-sm-9">
                <span class="select-box">
                <select class="select" size="1" name="WithdrawalType">
                    <option value="1" selected>提现比率</option>
                    <option value="2">固定金额</option>
                </select>
                </span>
			</div>
		</div>
		<div class="row cl" style="display: block;" id="ratediv">
			<label class="form-label col-xs-2 col-sm-2">商家提现比率：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" placeholder="" id="WithdrawalAmountRate" name="WithdrawalAmountRate" value="0" style="width:478px">
			</div>
		</div>
		<div class="row cl" style="display: none;" id="amountdiv">
			<label class="form-label col-xs-2 col-sm-2">商家提现固定金额：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" placeholder="" id="WithdrawalAmount" name="WithdrawalAmount" value="0" style="width:478px">
			</div>
		</div>
		<div class="row cl">
			<label class="form-label col-xs-2 col-sm-2">商家提现倍数：</label>
			<div class="formControls col-xs-10 col-sm-9">
				<input type="text" class="input-text" placeholder="" id="WithdrawalAmountLimit" name="WithdrawalAmountLimit"  style="width:478px">
			</div>
		</div>

		<div class="row cl">
			<div class="col-xs-10 col-sm-9 col-xs-offset-2 col-sm-offset-2">
				<input class="btn btn-primary radius" type="submit" value="提交并发布" />
			</div>
		</div>
	</form>
</div>
</div>

{include file="./public/Public/js_script.html" /}

<!--请在下方写此页面业务相关的脚本-->
<script src="<?php echo CSS_PATH;?>static/js/provinces.Cxselect.js"></script>
<script src="<?php echo CSS_PATH;?>static/js/provincesData.js"></script>
<script type="text/javascript" src="<?php echo CSS_PATH;?>lib/ueditor/1.4.3/ueditor.config.js"></script>
<script type="text/javascript" src="<?php echo CSS_PATH;?>lib/ueditor/1.4.3/ueditor.all.min.js"> </script>
<script type="text/javascript" src="<?php echo CSS_PATH;?>lib/ueditor/1.4.3/lang/zh-cn/zh-cn.js"></script>


<!--请在下方写此页面业务相关的脚本--> 
<script type="text/javascript">
$(function(){
    $("[name='WithdrawalType']").change(function(){
        var value=$(this).val();
        if(value==1){
            $('#ratediv').attr('style','display:block');
            $('#amountdiv').attr('style','display:none');
        }else{
            $('#ratediv').attr('style','display:none');
            $('#amountdiv').attr('style','display:block');
        }
    });

	$("#form_aupplier_add").validate({
		rules:{
			name:{
				required:true,
				minlength:2,
				maxlength:32
			},
			loginpasswd:{
				required:true,
				minlength:2,
				maxlength:32
			},
			supproductcate:{
				required:true,
			},
			
		},
		onkeyup:false,
		focusCleanup:true,
		success:"valid",
		submitHandler:function(form){
			$(form).ajaxSubmit();
			var index = parent.layer.getFrameIndex(window.name);
			parent.$('.btn-refresh').click();
			parent.layer.close(index);
		}
	});
});
function select_all(){ //全选     
  var inputs = document.getElementsByTagName("input");     
  for(var i=0;i<inputs.length;i++)     
  {     
	if(inputs[i].getAttribute("type") == "checkbox")     
	{     
	  inputs[i].checked = false;     
	}     
  }     
}     

function JudgeUserName()
{
	$.ajax({
	type:"GET",
	url:"supplier_add/action/checkuser/userid/"+document.getElementById("ReferrerID").value,
	dataType:"html",
	//data:"userName="+$("#txtName").val(),
	beforeSend:function(XMLHttpRequest)
		{
			$("#showResult").text("正在查询");
			//Pause(this,100000);
		},
	success:function(msg)
		{   
			$("#showResult").html(msg);
			$("#showResult").css("color","red");
		},
   complete:function(XMLHttpRequest,textStatus)
		{
			//隐藏正在查询图片
		},
  error:function()
	   {
			//错误处理
	   }
	});
}
//主营产品分类选择
function Cmd(obj){
	$(obj).next("div").find("div").each(function(){
		$(this).hide();
	});
	$("#x" + obj.value).show();
}

$(function(){
	$('.skin-minimal input').iCheck({
		checkboxClass: 'icheckbox-blue',
		radioClass: 'iradio-blue',
		increaseArea: '20%'
	});

    //编辑器
    $(function(){
        var ue = UE.getEditor('container');
        textarea:'content'; //与textarea的name值保持一致
        ue.addListener("ready", function() {
            // editor准备好之后才可以使用
            ue.setContent(result.container);
        });
        ue.ready(function () {
            // editor准备好之后才可以使用
            ue.setContent(result.container);
        });
    });
	
	
//主营产品类别	
	$(".permission-list2 dt input:checkbox").click(function(){
			$(this).closest("dl").find("dd input:checkbox").prop("checked",$(this).prop("checked"));
		});
	$(".permission-list2 dd input:checkbox").click(function(){
		if($(this).prop("checked")){
			$(this).closest("dl").find("dt input:checkbox").prop("checked",true);
		}
		else{
			//$(this).closest("dl").find("dt input:checkbox").prop("checked",false);
		}
	});

//地址选择
	cxSelect('cmbProvince', 'cmbCity', 'cmbArea');
});


//公司资质
var rowCount=1;  //行数默认1行
//添加行  
function addRow(){  
    rowCount++;  
    var newRow='<div id="option'+rowCount+'" class="mt-15"> <span class="btn-upload form-group"><input class="input-text upload-url radius" type="text" name="photo[]" id="photo[]" readonly> <a href="javascript:void();" class="btn btn-primary radius upload-btn"><i class="Hui-iconfont">&#xe642;</i> 浏览文件</a><input type="file" multiple name="photo[]" class="input-file"></span>  <a class="btn btn-default" href="###" onclick=delRow('+rowCount+')>删除</a>';
	$('#optionContainer').append(newRow); 
}
//删除行  
function delRow(rowIndex){  
    $("#option"+rowIndex).remove();  
    rowCount--;  
}
</script> 

<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>